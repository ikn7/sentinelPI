{"parentUuid":"26829eb7-64b1-4ec0-86dd-499bc537be7a","isSidechain":true,"userType":"external","cwd":"/home/user/stratwatch","sessionId":"55210cba-6312-4531-9066-f414f986b1c6","version":"2.1.29","gitBranch":"","agentId":"aprompt_suggestion-941ef0","slug":"smooth-booping-crab","message":{"model":"claude-opus-4-5-20251101","id":"msg_011BeyMhFxGp7RR4ixk86drQ","type":"message","role":"assistant","content":[{"type":"text","text":"# Guide d'utilisation StratWatch\n\n## 1. Configuration initiale\n\n### Variables d'environnement (`.env`)\n```bash\n# Clé API Pappers (données légales entreprises)\nPAPPERS_API_KEY=votre_cle_api\n\n# Notifications Telegram (optionnel)\nTELEGRAM_BOT_TOKEN=votre_token\nTELEGRAM_CHAT_ID=votre_chat_id\n\n# Notifications Email (optionnel)\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=587\nSMTP_USER=votre@email.com\nSMTP_PASSWORD=votre_mot_de_passe\n```\n\n### Concurrents à surveiller (`config/competitors.yaml`)\n```yaml\ncompetitors:\n  - siren: \"123456789\"\n    nom: \"Concurrent A\"\n    priorite: 1  # 1=haute, 2=moyenne, 3=basse\n    site_web: \"https://concurrent-a.com\"\n    mots_cles_presse:\n      - \"Concurrent A\"\n```\n\n## 2. Commandes CLI\n\n### Base de données\n```bash\n# Initialiser la base de données\npython -m src.cli db init\n\n# Réinitialiser (efface tout)\npython -m src.cli db reset\n```\n\n### Collecte de données\n```bash\n# Collecter toutes les sources\npython -m src.cli collect all\n\n# Collecter par source\npython -m src.cli collect legal --all      # Données Pappers\npython -m src.cli collect bodacc --all     # Annonces légales\npython -m src.cli collect regulations --all # Textes Légifrance\n\n# Collecter un concurrent spécifique\npython -m src.cli collect legal --siren 123456789\n\n# Rechercher une entreprise\npython -m src.cli collect search \"Nom entreprise\"\n```\n\n### Alertes\n```bash\n# Lister les alertes récentes\npython -m src.cli alerts list\npython -m src.cli alerts list --unread    # Non lues uniquement\n\n# Vérifier et générer de nouvelles alertes\npython -m src.cli alerts check\n\n# Envoyer les notifications en attente\npython -m src.cli alerts process\n\n# Envoyer un digest\npython -m src.cli alerts digest --period daily\npython -m src.cli alerts digest --period weekly\n\n# Tester les canaux de notification\npython -m src.cli alerts test\n```\n\n### Rapports\n```bash\n# Générer le rapport hebdomadaire\npython -m src.cli report weekly                # HTML par défaut\npython -m src.cli report weekly --format md    # Markdown\npython -m src.cli report weekly --format pdf   # PDF (nécessite WeasyPrint)\npython -m src.cli report weekly --format all   # Tous les formats\n\n# Générer un rapport concurrent\npython -m src.cli report competitor 123456789\n\n# Lister les rapports générés\npython -m src.cli report list\n```\n\n### Scheduler (automatisation)\n```bash\n# Démarrer le planificateur (tourne en continu)\npython -m src.cli scheduler start\n\n# Voir les tâches planifiées\npython -m src.cli scheduler jobs\n\n# Exécuter une tâche manuellement\npython -m src.cli scheduler run collect_legal\npython -m src.cli scheduler run check_alerts\npython -m src.cli scheduler run weekly_report\n\n# Voir l'état du scheduler\npython -m src.cli scheduler status\n```\n\n### API et Dashboard\n```bash\n# Démarrer l'API REST\npython -m src.cli api\n# → http://localhost:8000/docs (documentation Swagger)\n\n# Démarrer le dashboard Streamlit\npython -m src.cli dashboard\n# → http://localhost:8501\n```\n\n### Configuration\n```bash\n# Afficher la configuration\npython -m src.cli config --show\n\n# Vérifier la configuration\npython -m src.cli config --check\n```\n\n## 3. Tâches automatiques (Scheduler)\n\n| Tâche | Fréquence | Description |\n|-------|-----------|-------------|\n| `collect_legal` | 6h00 | Données Pappers |\n| `collect_bodacc` | 7h00, 19h00 | Annonces légales |\n| `collect_regulations` | 8h00, 20h00 | Textes Légifrance |\n| `check_alerts` | Toutes les 30 min | Génère les alertes |\n| `send_notifications` | Toutes les 15 min | Envoie les notifications |\n| `daily_digest` | 8h30 | Résumé quotidien |\n| `weekly_digest` | Lundi 8h00 | Résumé hebdomadaire |\n| `weekly_report` | Lundi 9h00 | Rapport PDF/HTML |\n\n## 4. Déploiement sur Raspberry Pi\n\n```bash\n# Créer un service systemd\nsudo nano /etc/systemd/system/stratwatch.service\n```\n\n```ini\n[Unit]\nDescription=StratWatch Scheduler\nAfter=network.target\n\n[Service]\nType=simple\nUser=pi\nWorkingDirectory=/home/pi/stratwatch\nExecStart=/home/pi/stratwatch/.venv/bin/python -m src.cli scheduler start\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n```\n\n```bash\n# Activer et démarrer\nsudo systemctl enable stratwatch\nsudo systemctl start stratwatch\nsudo systemctl status stratwatch\n```\n\n## 5. Structure des fichiers\n\n```\n~/stratwatch/\n├── config/\n│   ├── settings.yaml      # Configuration générale\n│   ├── competitors.yaml   # Concurrents à surveiller\n│   ├── sectors.yaml       # Secteurs réglementaires\n│   └── alerts.yaml        # Règles d'alertes\n├── data/\n│   ├── stratwatch.db      # Base SQLite\n│   └── exports/           # Rapports générés\n├── logs/                  # Fichiers de log\n└── .env                   # Variables d'environnement\n```\n\n## 6. Exemple d'utilisation quotidienne\n\n```bash\n# 1. Vérifier l'état\npython -m src.cli config --show\npython -m src.cli alerts list --unread\n\n# 2. Lancer une collecte manuelle si besoin\npython -m src.cli collect all\n\n# 3. Générer un rapport\npython -m src.cli report weekly --format html\n\n# 4. Consulter le dashboard\npython -m src.cli dashboard\n```"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":443,"cache_read_input_tokens":139612,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":443},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXjsUvPJgFw66jJL8na8t","type":"assistant","uuid":"ac4a44fe-d95e-468b-a2ee-90f3820445d2","timestamp":"2026-02-02T20:27:08.368Z"}
{"parentUuid":"ac4a44fe-d95e-468b-a2ee-90f3820445d2","isSidechain":true,"userType":"external","cwd":"/home/user/stratwatch","sessionId":"55210cba-6312-4531-9066-f414f986b1c6","version":"2.1.29","gitBranch":"","agentId":"aprompt_suggestion-941ef0","slug":"smooth-booping-crab","type":"user","message":{"role":"user","content":"[SUGGESTION MODE: Suggest what the user might naturally type next into Claude Code.]\n\nFIRST: Look at the user's recent messages and original request.\n\nYour job is to predict what THEY would type - not what you think they should do.\n\nTHE TEST: Would they think \"I was just about to type that\"?\n\nEXAMPLES:\nUser asked \"fix the bug and run tests\", bug is fixed → \"run the tests\"\nAfter code written → \"try it out\"\nClaude offers options → suggest the one the user would likely pick, based on conversation\nClaude asks to continue → \"yes\" or \"go ahead\"\nTask complete, obvious follow-up → \"commit this\" or \"push it\"\nAfter error or misunderstanding → silence (let them assess/correct)\n\nBe specific: \"run the tests\" beats \"continue\".\n\nNEVER SUGGEST:\n- Evaluative (\"looks good\", \"thanks\")\n- Questions (\"what about...?\")\n- Claude-voice (\"Let me...\", \"I'll...\", \"Here's...\")\n- New ideas they didn't ask about\n- Multiple sentences\n\nStay silent if the next step isn't obvious from what the user said.\n\nFormat: 2-12 words, match the user's style. Or nothing.\n\nReply with ONLY the suggestion, no quotes or explanation."},"uuid":"223fc6ec-d3fa-4682-bae2-595f2a010d29","timestamp":"2026-02-02T20:27:08.376Z"}
{"parentUuid":"223fc6ec-d3fa-4682-bae2-595f2a010d29","isSidechain":true,"userType":"external","cwd":"/home/user/stratwatch","sessionId":"55210cba-6312-4531-9066-f414f986b1c6","version":"2.1.29","gitBranch":"","agentId":"aprompt_suggestion-941ef0","slug":"smooth-booping-crab","message":{"model":"claude-opus-4-5-20251101","id":"msg_013nCpaVKTLAdCudf1B9efpA","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Looking at the conversation:\n1. The user asked to build a complete StratWatch application\n2. We built it step by step\n3. The user asked to run tests, then continue with various components\n4. User asked to generate a test report\n5. User asked to run a test collection\n6. User asked how to use the application\n7. I provided a comprehensive usage guide\n\nNow what would the user naturally type next? They've seen the full guide, the application is complete and working. Some natural follow-ups could be:\n- They might want to commit everything\n- They might want to try something specific from the guide\n- They might be done and just want to close\n\nGiven the French-speaking context and that they've been building this app, they might:\n- Want to commit the changes\n- Want to try the dashboard\n- Want to see something specific\n\nActually, looking at the flow, they've completed the application, tested it, and now have the documentation. A natural next step would be to either:\n1. Commit all the work\n2. Try the dashboard/API\n3. Deploy it\n\nGiven the context of a Raspberry Pi deployment mentioned in the guide, they might want to try running something or committing.\n\n\"lance le dashboard\" or \"commit tout\" seem like reasonable suggestions in French.\n\nActually, since we just explained everything and the user speaks French, they might want to try the dashboard to see it visually, or commit the work.\n\nI'll suggest trying the dashboard since it's a visual way to see everything working.","signature":"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"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":2004,"cache_read_input_tokens":140046,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":2004},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXjsXEkAdZHXeHkGaDbou","type":"assistant","uuid":"adf1e7bb-1268-4020-8187-cbaca3d6b987","timestamp":"2026-02-02T20:27:22.149Z"}
{"parentUuid":"adf1e7bb-1268-4020-8187-cbaca3d6b987","isSidechain":true,"userType":"external","cwd":"/home/user/stratwatch","sessionId":"55210cba-6312-4531-9066-f414f986b1c6","version":"2.1.29","gitBranch":"","agentId":"aprompt_suggestion-941ef0","slug":"smooth-booping-crab","message":{"model":"claude-opus-4-5-20251101","id":"msg_013nCpaVKTLAdCudf1B9efpA","type":"message","role":"assistant","content":[{"type":"text","text":"lance le dashboard"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":2004,"cache_read_input_tokens":140046,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":2004},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXjsXEkAdZHXeHkGaDbou","type":"assistant","uuid":"25d22093-d997-4ac4-bdff-cfaef3ec9f38","timestamp":"2026-02-02T20:27:22.214Z"}
